---
title: "simulation"
author: "Taenyoung Lee"
date: "2025-07-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 사용예시

```{r}
source("test_lossshift_twomoon_data.r")
```



```{r}
# 1) Clean 모드: 기본 두‐반달 위에서 train/test 아무 오염 없이,
#    (여기선 레이블 노이즈도 30%씩 넣어 봄)
res_clean <- repeat_benchmark(
  n_repeat  = 20,
  n_sample  = 200,
  data_mode = "clean",
  # make_two_moon_arg는 빈 리스트로 두면 clean 기본값(noise=0.15) 사용
  make_two_moon_arg = list(),
  flip_pos    = 0.30,   # train +1 레이블 30% 뒤집기
  flip_neg    = 0.30,   # train -1 레이블 30% 뒤집기
  ls_style    = c("none","soft","hard"),
  ls_kernel   = "linear",
  ls_svm_dual = FALSE
)

```


###

```{r}
# 2) Outlier 모드: train 특성에만 이상치 삽입, 레이블은 그대로
res_outlier <- repeat_benchmark(
  n_repeat  = 30,
  n_sample  = 200,
  data_mode = "outlier",
  make_two_moon_arg = list(
    noise = 0.2,
    out_frac_pos = 0.20,   # +1 클래스 이상치 비율
    out_frac_neg = 0.05,   # -1 클래스 이상치 비율
    out_dist     = 3       # 이상치 이동 거리
  ),
  flip_pos    = 0,
  flip_neg    = 0,
  ls_style    = c("none","soft","hard"),
  ls_kernel   = "gaussian",
  ls_svm_dual = TRUE
)

```


###

```{r}
# 3) Contam_pos 모드: train -1 클래스 일부를 +1 분포로 오염, 레이블은 그대로
res_contam <- repeat_benchmark(
  n_repeat  = 30,
  n_sample  = 200,
  data_mode = "contam_pos",
  make_two_moon_arg = list(
    noise        = 0.15,  # 기본 노이즈
    contam_frac  = 0.25   # -1 클래스 중 25%를 +1 분포로 오염
  ),
  flip_pos    = 0,
  flip_neg    = 0,
  ls_style    = c("none","soft","hard"),
  ls_kernel   = "gaussian",
  ls_svm_dual = TRUE
)

```


########################################################################################
#### NEW ###############################################################################
########################################################################################

```{r}
source("test_lossshift_twomoon_data_v2.r")
```

```{r}
# 1) clean 모드: 특성·레이블 모두 깨끗, 그 위에 flip만 적용
res_clean <- repeat_benchmark(
  n_repeat  = 20,
  n_sample  = 300,
  data_mode = "clean",
  make_two_moon_arg = list(),   # clean이기 때문에 빈 리스트
  flip_pos  = 0.20,             # train +1 레이블 20% 뒤집기
  flip_neg  = 0.10,             # train −1 레이블 10% 뒤집기
  ls_style    = c("none","soft","hard"),
  ls_kernel   = "linear",
  ls_svm_dual = FALSE
)

```


```{r}
# 2) outlier 모드: train 특성만 outlier 삽입(레이블 유지)
res_outlier <- repeat_benchmark(
  n_repeat  = 30,
  n_sample  = 200,
  data_mode = "outlier",
  make_two_moon_arg = list(
    noise = 0.2,
    out_frac_pos = 0.15,  # +1 클래스에서 15% 포인트를 이상치로
    out_frac_neg = 0.05,  # −1 클래스에서 5% 포인트를 이상치로
    out_dist     = 4      # 원점에서 4만큼 멀리 이동
  ),
  flip_pos    = 0,      # 레이블 flip 없이
  flip_neg    = 0,
  ls_style    = c("none","soft","hard"),
  ls_kernel   = "gaussian",
  ls_svm_dual = TRUE
)

```


```{r}
# 3) outlier_flip 모드: train 특성만 outlier 삽입 + 그 포인트 레이블만 뒤집기
res_outlier_flip <- repeat_benchmark(
  n_repeat  = 30,
  n_sample  = 300,
  data_mode = "outlier_flip",
  make_two_moon_arg = list(
    noise = 0.2,
    out_frac_pos = 0.3,
    out_frac_neg = 0.05,
    out_dist     = 6
  ),
  # flip_pos/flip_neg는 여기서 무시(이상치 포인트만 flip)
  flip_pos    = 0,
  flip_neg    = 0,
  ls_style    = c("none","soft","hard"),
  ls_kernel   = "gaussian",
  ls_svm_dual = TRUE
)
write.csv(res_outlier_flip$raw, "0718test_rep30_sample300_outp03_outneg005_dist4.csv")
```



```{r}
# 4) contam_pos 모드: train −1 클래스 일부를 +1 분포로 오염(특성만 교체)
res_contam_pos <- repeat_benchmark(
  n_repeat  = 30,
  n_sample  = 200,
  data_mode = "contam_pos",
  make_two_moon_arg = list(
    noise       = 0.10,  # 오염 생성시 사용 노이즈
    contam_frac = 0.30   # −1 클래스의 30%를 +1 분포로
  ),
  flip_pos    = 0,    # 레이블은 오염만(교체된 특성)으로 유지
  flip_neg    = 0,
  ls_style    = c("none","soft","hard"),
  ls_kernel   = "gaussian",
  ls_svm_dual = FALSE
)

```


```{r}
# 5) contam_specific 모드: 지정한 레이블 일부를 반대 클래스 분포로 오염
#    예: +1 레이블 20%를 −1 분포로 오염
res_contam_spec <- repeat_benchmark(
  n_repeat  = 30,
  n_sample  = 200,
  data_mode = "contam_specific",
  make_two_moon_arg = list(
    contam_label =  1,    # 오염할 레이블: +1
    contam_frac  =  0.20, # +1 클래스의 20%
    noise        =  0.15  # 오염시 노이즈
  ),
  flip_pos    = 0,       # 레이블은 그대로(오염된 특성만)
  flip_neg    = 0,
  ls_style    = "none",
  ls_kernel   = "linear",
  ls_svm_dual = FALSE
)

```

```{r}
source("test_lossshift_twomoon_data_v3.r")

# 2) linear_sep 모드로 한 번 실행해 보기
set.seed(42)
res_repeat <- repeat_benchmark(
  n_repeat = 30,
  n_sample               = 400,           # 전체 샘플 수
  test_frac       = 0.3,            # 테스트 비율
  data_mode       = "linear_sep",   # 선형분리 모드
  flip_train_frac = list(pos = 0.4, neg = 0.1),   # train에서 클래스별 10%씩 레이블 뒤집기
  flip_test_frac  = list(pos = 0, neg = 0), # test에서 클래스별 5%씩 레이블 뒤집기
  cv_folds        = 5,              # 교차검증 폴드 수
)
write.csv(res_repeat$raw, "0807_30rep_400sam.csv")
```


